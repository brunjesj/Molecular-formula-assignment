This code uses fast vectorized calculations within R data.table to assign molecular formulas to m/z values generated by high-resolution mass spectrometry.
The basic idea follows the principles outlined by Merder el al 2020 (https://pubs.acs.org/doi/full/10.1021/acs.analchem.9b05659) which is available as the free online-tool ICBM ocean (https://rhea.icbm.uni-oldenburg.de/geomol/)

The code presented here is magnitudes faster compared to running the same samples on the online-server of ICBM ocean.
On a standard laptop, processing of 24 samples and noise calculation from 5 instrument blanks takes about 30 seconds from loading the samples into the workspace to generate an output table of molecular formulas.
The steps include estimating noise based on instrument blanks, applying an automatic recalibration, merging of samples into a single mastertable, calculation of isotope ratios and homologues network series.
A reference table of potential molecular formulas is generated and molecular formulas assigned to mass peaks within a defined tolerance range.
